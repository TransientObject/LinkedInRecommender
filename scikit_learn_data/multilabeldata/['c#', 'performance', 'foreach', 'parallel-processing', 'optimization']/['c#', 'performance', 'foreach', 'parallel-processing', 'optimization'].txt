Performance optimization of foreach loop in C#
